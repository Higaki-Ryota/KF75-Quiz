import{q as i,_ as C,a as A,b as E}from"./DlzaIm6_.js";import{g as D,s as V}from"./BDA1vHQe.js";import{f as x}from"./C3hsaTmO.js";import{d as K,r as u,o as Q,x as j,B as J,J as q,K as O,L as m,g as R,y as k}from"./B2226xQw.js";const X=K({__name:"index",setup(U){const z={apiKey:"AIzaSyD1LeqIBFxE6wU2gE2xDTeSV_O4xTQSazw",authDomain:"kf75-8d355.firebaseapp.com",projectId:"kf75-8d355",storageBucket:"kf75-8d355.firebasestorage.app",messagingSenderId:"385498511746",appId:"1:385498511746:web:9fc5581c8479ac83abf79b"};x.initializeApp(z);const M=x.firestore(),r=u("menu"),w=i.map(a=>Array.from({length:a.length},(e,t)=>t)),s=u(w.map(a=>D(a,a.length))),l=u(0),I=[["6級","小中学生初級","制限時間：60秒"],["5級","小中学生上級","制限時間：60秒"],["4級","高校生初級","制限時間：60秒"],["3級","高校生上級","制限時間：60秒"],["2級","大学生初級","制限時間：60秒"],["1級","大学生上級","制限時間：60秒"]],o=u([]),h=u([]),F=a=>{l.value=a,r.value="question",s.value=w.map(e=>D(e,e.length)),v.value=60,d.value=Date.now(),M.collection("kf75").where("level","==",l.value).where("when.day","==",24).get().then(e=>{e&&e.forEach(t=>{o.value.push(t.data())})}).catch(e=>{})},n=u(0),c=u(0),g=u(0),S=u(null),v=u(6),H=()=>{V(()=>{if(r.value==="question"&&v.value>0&&v.value--,v.value<=g.value*5){const a=new Date;a.toLocaleString,o.value.push({level:l.value,score:c.value,when:{year:a.getFullYear(),month:a.getMonth()+1,day:a.getDate(),hour:a.getHours(),minute:a.getMinutes(),sortdata:a.getFullYear()*1e8+a.getMonth()*1e6+a.getDate()*1e4+a.getHours()*100+a.getMinutes()},color:"red"}),o.value.sort((e,t)=>t.when.sortdata-e.when.sortdata),o.value.sort((e,t)=>t.score-e.score);for(let e=0;e<Math.min(o.value.length,6);e++)h.value.push({score:o.value[e].score,when:o.value[e].when,color:o.value[e].color});r.value="result",v.value=60,console.log(h.value),M.collection("kf75").add({level:l.value,score:c.value,when:{year:a.getFullYear(),month:a.getMonth()+1,day:a.getDate(),hour:a.getHours(),minute:a.getMinutes(),sortdata:a.getFullYear()*1e8+a.getMonth()*1e6+a.getDate()*1e4+a.getHours()*100+a.getMinutes()},color:"black"}).then(e=>{console.log("追加成功")}).catch(e=>{console.log(e)})}},1e3)};Q(()=>{H()});const p=u(!1),_=u(!1),y=u(!1),d=u(0),b=u(0),T=a=>{if(p.value===!1&&v.value>0){if(b.value=Date.now(),p.value=!0,a)c.value++,S.value="正解！",_.value=!0;else if(g.value++,S.value="不正解",y.value=!0,v.value<=g.value*5){const e=new Date;e.toLocaleString,o.value.push({level:l.value,score:c.value,when:{year:e.getFullYear(),month:e.getMonth()+1,day:e.getDate(),hour:e.getHours(),minute:e.getMinutes(),sortdata:e.getFullYear()*1e8+e.getMonth()*1e6+e.getDate()*1e4+e.getHours()*100+e.getMinutes()},color:"red"}),o.value.sort((t,f)=>f.when.sortdata-t.when.sortdata),o.value.sort((t,f)=>f.score-t.score);for(let t=0;t<Math.min(o.value.length,6);t++)h.value.push({score:o.value[t].score,when:o.value[t].when,color:o.value[t].color});r.value="result",v.value=60,console.log(h.value),M.collection("kf75").add({level:l.value,score:c.value,when:{year:e.getFullYear(),month:e.getMonth()+1,day:e.getDate(),hour:e.getHours(),minute:e.getMinutes(),sortdata:e.getFullYear()*1e8+e.getMonth()*1e6+e.getDate()*1e4+e.getHours()*100+e.getMinutes()},color:"black"}).then(t=>{console.log("追加成功")}).catch(t=>{console.log(t)})}b.value<d.value+2e3?setTimeout(()=>{n.value++,d.value=Date.now(),p.value=!1,_.value=!1,y.value=!1},3e3+d.value-b.value):setTimeout(()=>{n.value++,d.value=Date.now(),p.value=!1,_.value=!1,y.value=!1},1e3)}},Y=()=>{r.value="menu",n.value=0,c.value=0,g.value=0,s.value=w.map(a=>D(a,a.length)),o.value=[]},L=()=>{r.value="menu",n.value=0,c.value=0,g.value=0,s.value=w.map(a=>D(a,a.length))};return(a,e)=>{const t=R("a-background"),f=E,N=C,B=A;return k(),j("div",null,[J(t),r.value==="menu"?(k(),q(f,{key:0,onSelect:F,Levels:I})):r.value==="question"?(k(),q(N,{key:1,count:v.value-g.value*5,correctIndex:m(i)[l.value][s.value[l.value][n.value]].answer,quizIndex:n.value,quizNumber:s.value[l.value][n.value],correctNumber:c.value,answerDisplay:p.value,correctDisplay:_.value,incorrectDisplay:y.value,question:m(i)[l.value][s.value[l.value][n.value]].question,options:m(i)[l.value][s.value[l.value][n.value]].options,fontSize:m(i)[l.value][s.value[l.value][n.value]].fontSize,answer:m(i)[l.value][s.value[l.value][n.value]].options[m(i)[l.value][s.value[l.value][n.value]].answer],onSelect:T,onTimeout:a.timeout,onQuit:L},null,8,["count","correctIndex","quizIndex","quizNumber","correctNumber","answerDisplay","correctDisplay","incorrectDisplay","question","options","fontSize","answer","onTimeout"])):r.value==="result"?(k(),q(B,{key:2,"correct-count":c.value,ranking:h.value,onSelect:Y},null,8,["correct-count","ranking"])):O("",!0)])}}});export{X as default};
